webpackJsonp([19],{pvqZ:function(t,e){},yz5d:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("rVsN"),l=a.n(n),s=a("gyMJ"),i={components:{TopHeader:a("Cz8s").a},data:function(){return{page:{total:0,size:10,current:1,sizes:[10,20,50,100]},tableData:[],filterCondition:{content:"",status:0,page:1,per_page:10},statusCode:{0:"不限",1:"审批中",2:"已驳回",3:"已通过"}}},computed:{cptPagination:function(){return this.page.total>=10}},created:function(){this.getSearchData()},methods:{getSearchData:function(){var t=this;s.a.getApprovalList(this.filterCondition).then(function(e){t.tableData=e.result.data,t.page.total=e.result.pagination.total_count})},handleSizeChange:function(t){t&&(this.filterCondition.per_page=t),this.page.current=this.filterCondition.page=1,this.getSearchData()},handleCurrentPageChange:function(t){this.filterCondition.page=t,this.getSearchData()},handlePass:function(t){var e=this;return s.a.putApprovalId(t).then(function(t){return 200===t.code?(e.getSearchData(),l.a.resolve(!0)):l.a.resolve(!1)})},handleReject:function(t,e){var a=this,n={content:e};return s.a.patchApprovalId(t,n).then(function(t){return 200===t.code?(a.getSearchData(),l.a.resolve(!0)):l.a.resolve(!1)})},filterKey:function(t,e){return t.map(function(t){return t[e]})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("top-header",{attrs:{title:"我的审批"}}),t._v(" "),a("div",{staticClass:"page-container"},[a("div",{staticClass:"table-filters"},[a("div",{staticClass:"filter-item"},[a("p",{staticClass:"item"},[t._v("角色名称")]),t._v(" "),a("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:t.filterCondition.content,callback:function(e){t.$set(t.filterCondition,"content",e)},expression:"filterCondition.content"}})],1),t._v(" "),a("div",{staticClass:"filter-item"},[a("p",{staticClass:"item"},[t._v("流程状态")]),t._v(" "),a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:t.filterCondition.status,callback:function(e){t.$set(t.filterCondition,"status",e)},expression:"filterCondition.status"}},t._l(t.statusCode,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:parseInt(e)}})}))],1),t._v(" "),a("div",{staticClass:"search-btn"},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(e){t.handleSizeChange()}}},[t._v("查询\n        ")])],1)]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,size:"mini"}},[a("el-table-column",{attrs:{fixed:"",prop:"id",type:"index",label:"序号",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{label:"申请内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{to:{path:"/process-management/approval/"+e.row.id}}},[a("el-button",{attrs:{size:"mini",type:"text"}},[t._v(t._s(e.row.content))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"申请权限用户"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.$utils.joinName(t.filterKey(e.row.user,"name")))+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"applicant",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"department_name",label:"所属部门"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"流程状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:{color:t.$utils.checkStatus(e.row.status,"color")}},[t._v("\n            "+t._s(t.$utils.checkStatus(e.row.status))+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text",disabled:t.$utils.isNotEqual(e.row.status,1)}},[a("kye-confirm",{attrs:{disabled:t.$utils.isNotEqual(e.row.status,1),label:"通过",title:"通过权限申请",content:"确定通过权限申请流程？点击确定后访问权限将自动开通！",callback:t.handlePass,"scope-data":e.row}})],1),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text",disabled:t.$utils.isNotEqual(e.row.status,1)}},[a("kye-prompt",{attrs:{disabled:t.$utils.isNotEqual(e.row.status,1),label:"驳回",title:"请输入驳回申请权限原因",callback:t.handleReject,"scope-data":e.row}})],1)]}}])})],1),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.cptPagination,expression:"cptPagination"}],attrs:{background:"","page-sizes":t.page.sizes,layout:"sizes,prev,pager,next","current-page":t.page.current,total:t.page.total,"prev-text":"上一页","next-text":"下一页"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentPageChange,"update:currentPage":function(e){t.$set(t.page,"current",e)}}})],1)],1)},staticRenderFns:[]};var o=a("vSla")(i,r,!1,function(t){a("pvqZ")},"data-v-14b41eae",null);e.default=o.exports}});
//# sourceMappingURL=19.e141d20c56ea75d073d9.js.map