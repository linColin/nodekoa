webpackJsonp([2],{PMJ1:function(t,a){},bT7X:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("hpcr"),s=e("TtmE"),n=e("gyMJ"),l={components:{TopHeaderBack:i.a,KyeDialog:s.a},data:function(){return{page:{left:{total:100,current:1,size:10},right:{total:100,current:1,size:10}},applicationId:void 0,nodeId:void 0,pageData:"",flow:[],tableData:[],dialogTableData:{left:[],right:[]},kyeDialog:{hasDialog:!1,title:"审批节点详情"},stepsNum:1}},computed:{cptLeftPagination:function(){return this.page.left.total>=10},cptRightPagination:function(){return this.page.left.total>=10},cptStepsNum:function(){for(var t=this.flow||[],a=1,e=0,i=t.length;e<i-1;e++){if(3!==t[e].status){a=t[e].level;break}a=i+1}return a}},created:function(){var t=this;this.applicationId=this.$route.params.id,n.a.getApplicationId(this.applicationId).then(function(a){t.pageData=a.result,t.tableData=a.result.user,t.flow=a.result.flow,t.flow.push({name:"完成"})})},methods:{handleDialog:function(t){var a=this;if(!t)return!1;var e=this.dialogTableData;e.right=[],this.nodeId=t,n.a.getApplicationNodeUser(this.applicationId,this.nodeId).then(function(t){var i=t.result;e.left=i.data,a.page.left.total=i.pagination.total_count,a.isShowDialog(!0)})},handleApprovalDetail:function(t,a){var e=this;3!==t?n.a.getApplicationNodeUserDateil(this.applicationId,this.nodeId,a).then(function(t){var a=t.result,i=e.dialogTableData;i.right=[],i.right.push(a),e.page.right.total=1}):n.a.getApplicationNodeRoleDateil(this.applicationId,this.nodeId,a).then(function(t){var a=t.result,i=e.dialogTableData;i.right=[],i.right=a.data,e.page.right.total=a.pagination.total_count})},isShowDialog:function(t){if(void 0===t)return this.isShowDialog(!1),!1;this.kyeDialog.hasDialog=t},getSearchData:function(){var t=this;n.a.getApplicationList(this.filterCondition).then(function(a){t.tableData=a.result.data})},handleSizeChange:function(t){t&&(this.filterCondition.per_page=t),this.page.current=this.filterCondition.page=1,this.getSearchData()},handleCurrentPageChange:function(t){this.filterCondition.page=t,this.getSearchData()},handleTableBtn:function(t){return n.a.putApplicationId(t)}}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("top-header-back",{attrs:{title:"申请流程详情"}}),t._v(" "),e("div",{staticClass:"page-container"},[e("div",{staticClass:"steps"},[e("h2",{staticClass:"sub-header"},[t._v("审批进度")]),t._v(" "),e("div",{staticClass:"steps-msg"},[t._v(t._s(t._f("datetime")(t.pageData.created_at))+"\n        "),e("span",[t._v(t._s(t.pageData.applicant))]),t._v("提交申请，\n        "),e("span",[t._v("流程已用时"+t._s(t.pageData.used_time))]),t._v("。\n      ")]),t._v(" "),e("el-steps",{attrs:{active:t.cptStepsNum,"align-center":"",space:"30%"}},[e("el-step",{attrs:{title:t.pageData.applicant,icon:"el-icon-circle-check"}}),t._v(" "),t._l(t.flow,function(a,i){return e("el-step",{key:i,attrs:{icon:"el-icon-circle-check"}},[e("template",{slot:"title"},[e("el-button",{attrs:{type:"text",size:"small",disabled:!a.level},on:{click:function(e){t.handleDialog(a.id)}}},[t._v("\n              "+t._s(a.level?t.$utils.checkLevel(a.level):a.name)+"\n            ")])],1)],2)})],2)],1),t._v(" "),e("div",{staticClass:"steps-content"},[e("h2",{staticClass:"sub-header"},[t._v("申请内容")]),t._v(" "),e("ul",[e("li",{staticClass:"msg-block"},[e("span",{staticClass:"name"},[t._v("申请内容")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.pageData.content))])]),t._v(" "),e("li",{staticClass:"msg-block"},[e("span",{staticClass:"name"},[t._v("申请角色名称")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.pageData.content))])]),t._v(" "),e("li",{staticClass:"msg-block"},[e("span",{staticClass:"name"},[t._v("流程状态")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.pageData.content))])]),t._v(" "),e("li",{staticClass:"msg-block"},[e("span",{staticClass:"name"},[t._v("申请状态")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.$utils.checkStatus(t.pageData.status)))])]),t._v(" "),e("li",{staticClass:"msg-block"},[e("span",{staticClass:"name"},[t._v("申请备注")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.pageData.remark))])]),t._v(" "),e("li",{staticClass:"msg-block"},[e("span",{staticClass:"name"},[t._v("审批备注")]),t._v(" "),e("span",{staticClass:"content"},[t._v(t._s(t.pageData.rejected_reason||"无"))])])])]),t._v(" "),e("div",{staticClass:"steps-user"},[e("h2",{staticClass:"sub-header"},[t._v("申请角色用户")]),t._v(" "),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,size:"mini"}},[e("el-table-column",{attrs:{type:"index",prop:"index",label:"序号",width:"60"}}),t._v(" "),e("el-table-column",{attrs:{prop:"name",label:"用户姓名"}}),t._v(" "),e("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"组织路径"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n            "+t._s(a.row.department_route)+"\n          ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"position",label:"工作职务"}}),t._v(" "),e("el-table-column",{attrs:{label:"入职时间",width:"125"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n            "+t._s(t._f("datetime")(a.row.created_at))+"\n          ")]}}])})],1)],1),t._v(" "),e("kye-dialog",{attrs:{width:"772px",hasDialog:t.kyeDialog.hasDialog,title:t.kyeDialog.title},on:{"is-show-dialog":t.isShowDialog}},[e("template",{slot:"body"},[e("div",{staticClass:"node-content"},[e("div",{staticClass:"left"},[e("h2",{staticClass:"sub-header"},[t._v("审批节点详情")]),t._v(" "),e("el-table",{attrs:{data:t.dialogTableData.left,size:"mini"}},[e("el-table-column",{attrs:{label:"审批类型"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n                    "+t._s(t.$utils.checkStep(a.row.approval_type))+"\n                  ")]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"审批人/角色"},scopedSlots:t._u([{key:"default",fn:function(a){return[t.$utils.isNotEqual(a.row.approval_type,3)?e("div",{staticClass:"table-btn",on:{click:function(e){t.handleApprovalDetail(a.row.approval_type,a.row.approval_user_id)}}},[t._v("\n                      "+t._s(a.row.approval_user_name)+"\n                    ")]):e("div",{staticClass:"table-btn",on:{click:function(e){t.handleApprovalDetail(a.row.approval_type,a.row.approval_role_id)}}},[t._v("\n                      "+t._s(a.row.approval_role_name)+"\n                    ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"流程状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{style:{color:t.$utils.checkStatus(a.row.status,"color")}},[t._v("\n                      "+t._s(t.$utils.checkStatus(a.row.status))+"\n                    ")])]}}])})],1),t._v(" "),e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.cptLeftPagination,expression:"cptLeftPagination"}],staticStyle:{"text-align":"left"},attrs:{background:"","pager-count":5,"page-size":t.page.left.size,layout:"prev,pager,next","current-page":t.page.left.current,total:t.page.left.total,"prev-text":"上一页","next-text":"下一页"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentPageChange,"update:currentPage":function(a){t.$set(t.page.left,"current",a)}}})],1),t._v(" "),e("div",{staticClass:"right"},[e("h2",{staticClass:"sub-header"},[t._v("审批角色详情")]),t._v(" "),e("el-table",{attrs:{data:t.dialogTableData.right,size:"mini"}},[e("el-table-column",{attrs:{prop:"approval_user_name",label:"姓名"}}),t._v(" "),e("el-table-column",{attrs:{prop:"department_name",label:"所属部门"}})],1),t._v(" "),e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.cptRightPagination,expression:"cptRightPagination"}],staticStyle:{"text-align":"left"},attrs:{background:"","pager-count":5,"page-size":t.page.right.size,layout:"prev,pager,next","current-page":t.page.right.current,total:t.page.right.total,"prev-text":"上一页","next-text":"下一页"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentPageChange,"update:currentPage":function(a){t.$set(t.page.right,"current",a)}}})],1)])]),t._v(" "),e("template",{slot:"footer"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(a){t.isShowDialog()}}},[t._v("确认")])],1)],2)],1)],1)},staticRenderFns:[]};var r=e("vSla")(l,o,!1,function(t){e("gNRZ")},"data-v-1b3a8644",null);a.default=r.exports},gNRZ:function(t,a){},hpcr:function(t,a,e){"use strict";var i={data:function(){return{}},props:{title:{type:String,required:!0}}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-header",[e("div",{staticClass:"header-icon"},[e("div",{staticClass:"icon-box",on:{click:function(a){t.$router.go(-1)}}},[e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-back"}})])]),t._v(" "),e("div",{staticClass:"fl title"},[t._v(t._s(t.title))]),t._v(" "),e("div",{staticClass:"fr link"},[t._t("default")],2)])])},staticRenderFns:[]};var n=e("vSla")(i,s,!1,function(t){e("PMJ1")},"data-v-cdf43dde",null);a.a=n.exports}});
//# sourceMappingURL=2.2e7ac2498225c02765da.js.map