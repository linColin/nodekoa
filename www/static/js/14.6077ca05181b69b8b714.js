webpackJsonp([14],{ZzxX:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("4YfN"),s=i.n(a),n=i("gyMJ"),r=i("Cz8s"),l=i("45w3"),o=i("zAgK"),c={components:{TopHeader:r.a,SystemItem:l.a,FilterTree:o.a},data:function(){return{page:{total:0,size:10,current:1,sizes:[10,20,50,100]},tableData:[],currentName:void 0,filterCondition:{employee_code:void 0,user_name:void 0,position:void 0,department_name:void 0},currentKey:null,systems:[]}},methods:{requestList:function(){var e=this,t=s()({},this.filterCondition,{page:this.page.current,per_page:this.page.size});n.a.getSystemUsers(this.currentKey,t).then(function(t){var i=t.result||{};e.page.total=i.pagination?i.pagination.total_count:0,e.tableData=i.data||[]})},searchList:function(){if(!this.currentKey)return this.$message({type:"warning",message:"请先选择一个系统!"}),void this.$refs.treeRef.$refs.filterInput.focus();this.page.current=1,this.requestList()},handleSizeChange:function(e){this.page.size=e,this.requestList()},handleCurrentChange:function(e){this.page.current=e,this.requestList()},requestSystemTree:function(){var e=this;n.a.searchSys({per_page:1e3,page:1}).then(function(t){var i=[{id:-1,name:"基本系统",children:[]},{id:-2,name:"业务系统",children:[]}];((t.result||{}).data||[]).forEach(function(e){1===e.type?i[0].children.push(e):i[1].children.push(e)}),e.systems=i})},handleNodeClick:function(e,t,i){t.isLeaf?(this.filterCondition.employee_code=void 0,this.filterCondition.user_name=void 0,this.filterCondition.position=void 0,this.filterCondition.department_name=void 0,this.currentKey=e.id,this.currentName=e.name,this.page.current=1,this.requestList(),this.$refs.treeRef.$refs.tree.setCurrentKey(e.id)):this.$refs.treeRef.$refs.tree.setCurrentKey(this.currentKey)}},beforeMount:function(){this.requestSystemTree()}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-box"},[i("top-header",{attrs:{title:"系统权限审计"}}),e._v(" "),i("div",{staticClass:"page-container"},[i("div",{staticClass:"box-tree"},[i("strong",{staticClass:"box-title"},[e._v("系统列表")]),e._v(" "),i("div",{staticClass:"tree-wraper"},[i("div",{staticClass:"tree-box"},[i("div",{staticClass:"filter-tree-box"},[i("filter-tree",{ref:"treeRef",attrs:{"default-expand-all":!0,data:e.systems,placeholder:"请输入系统名称"},on:{"node-click":e.handleNodeClick}})],1)])])]),e._v(" "),i("div",{staticClass:"box-list"},[i("strong",{staticClass:"box-title"},[e._v("员工列表"),i("span",{directives:[{name:"show",rawName:"v-show",value:e.currentName,expression:"currentName"}]},[e._v(e._s("-  "+e.currentName))])]),e._v(" "),i("div",{staticClass:"user-box"},[i("div",{staticClass:"table-filters"},[i("div",{staticClass:"filter-item"},[i("p",{staticClass:"item"},[e._v("工号")]),e._v(" "),i("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.filterCondition.employee_code,callback:function(t){e.$set(e.filterCondition,"employee_code",t)},expression:"filterCondition.employee_code"}})],1),e._v(" "),i("div",{staticClass:"filter-item"},[i("p",{staticClass:"item"},[e._v("姓名")]),e._v(" "),i("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.filterCondition.user_name,callback:function(t){e.$set(e.filterCondition,"user_name",t)},expression:"filterCondition.user_name"}})],1),e._v(" "),i("div",{staticClass:"filter-item"},[i("p",{staticClass:"item"},[e._v("职位")]),e._v(" "),i("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.filterCondition.position,callback:function(t){e.$set(e.filterCondition,"position",t)},expression:"filterCondition.position"}})],1),e._v(" "),i("div",{staticClass:"filter-item"},[i("p",{staticClass:"item"},[e._v("部门")]),e._v(" "),i("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入"},model:{value:e.filterCondition.department_name,callback:function(t){e.$set(e.filterCondition,"department_name",t)},expression:"filterCondition.department_name"}})],1),e._v(" "),i("div",{staticClass:"search-btn"},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.searchList}},[e._v("查询\n             ")])],1)]),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n               "+e._s((e.page.current-1)*e.page.size+t.$index+1)+"\n             ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"employee_code",label:"工号"}}),e._v(" "),i("el-table-column",{attrs:{prop:"user_name",label:"姓名"}}),e._v(" "),i("el-table-column",{attrs:{prop:"position",label:"职位"}}),e._v(" "),i("el-table-column",{attrs:{prop:"department_name",label:"部门"}}),e._v(" "),i("el-table-column",{attrs:{prop:"registered_at",label:"入职时间",width:"125"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n               "+e._s(e._f("datetime")(t.row.updated_at))+"\n             ")]}}])})],1),e._v(" "),i("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.page.total>e.page.sizes[0],expression:"page.total > page.sizes[0]"}],attrs:{background:"","page-sizes":e.page.sizes,layout:"sizes,prev,pager,next","current-page":e.page.current,total:e.page.total,"prev-text":"上一页","next-text":"下一页"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"current",t)}}})],1)])])],1)},staticRenderFns:[]};var u=i("vSla")(c,d,!1,function(e){i("nd6X")},"data-v-42142ce3",null);t.default=u.exports},nd6X:function(e,t){}});
//# sourceMappingURL=14.6077ca05181b69b8b714.js.map